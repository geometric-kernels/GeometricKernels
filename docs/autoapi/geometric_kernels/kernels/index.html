<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex.html"><link rel="search" title="Search" href="../../../search.html"><link rel="next" title="geometric_kernels.kernels.base" href="base/index.html"><link rel="prev" title="geometric_kernels.jax" href="../jax/index.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>geometric_kernels.kernels - GeometricKernels documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/bootstrap_namespaced.css?v=7458e3c8" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">GeometricKernels  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  <span class="sidebar-brand-text">GeometricKernels  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">GeometricKernels</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../examples/index.html">Examples</a><input aria-label="Toggle navigation of Examples" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../examples/examples.html">Spaces</a><input aria-label="Toggle navigation of Spaces" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/CustomSpacesAndKernels.html">Custom Spaces and Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Graph.html">Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/GraphEdges.html">GraphEdges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/HammingGraph.html">HammingGraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Hyperbolic.html">Hyperbolic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/HypercubeGraph.html">HypercubeGraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Hypersphere.html">Hypersphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/SPD.html">SPD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/SpecialOrthogonal.html">SpecialOrthogonal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/SpecialUnitary.html">SpecialUnitary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/Torus.html">Torus</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../examples/examples.html#backends">Backends</a><input aria-label="Toggle navigation of Backends" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/backends/JAX_Graph.html">JAX (Graph space)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/backends/PyTorch_Graph.html">PyTorch (Graph space)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/backends/TensorFlow_Graph.html">TensorFlow (Graph space)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../examples/examples.html#frontends">Frontends</a><input aria-label="Toggle navigation of Frontends" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/frontends/GPflow.html">GPFlow (Mesh space)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/frontends/GPJax.html">GPJax (Mesh space)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/frontends/GPyTorch.html">GPyTorch (Mesh space)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../examples/examples.html#other">Other</a><input aria-label="Toggle navigation of Other" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/other/Bayesian%20Optimization.html">Bayesian optimization on a sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/other/Hyperbolic%20Approximations.html">Comparing approximations on Hyperbolic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/other/SPD%20Approximations.html">Comparing approximations on SPD</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../theory/index.html">Theory</a><input aria-label="Toggle navigation of Theory" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/compact.html">Kernels on compact manifolds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/addition_theorem.html">Addition theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/graphs.html">Kernels on graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/meshes.html">Kernels on meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/symmetric.html">Kernels on non-compact symmetric spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/product_spaces.html">Kernels on product spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/product_kernels.html">Product kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/feature_maps.html">Feature maps and sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/hypercube_graph.html">Hypercube graph space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/hamming_graph.html">Hamming graph space</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">API reference</a><input aria-label="Toggle navigation of API reference" checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../feature_maps/index.html">geometric_kernels.feature_maps</a><input aria-label="Toggle navigation of geometric_kernels.feature_maps" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../feature_maps/base/index.html">geometric_kernels.feature_maps.base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../feature_maps/deterministic/index.html">geometric_kernels.feature_maps.deterministic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../feature_maps/probability_densities/index.html">geometric_kernels.feature_maps.probability_densities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../feature_maps/random_phase/index.html">geometric_kernels.feature_maps.random_phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../feature_maps/rejection_sampling/index.html">geometric_kernels.feature_maps.rejection_sampling</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../frontends/index.html">geometric_kernels.frontends</a><input aria-label="Toggle navigation of geometric_kernels.frontends" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../frontends/gpflow/index.html">geometric_kernels.frontends.gpflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../frontends/gpjax/index.html">geometric_kernels.frontends.gpjax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../frontends/gpytorch/index.html">geometric_kernels.frontends.gpytorch</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../jax/index.html">geometric_kernels.jax</a></li>
<li class="toctree-l2 current has-children current-page"><a class="current reference internal" href="#">geometric_kernels.kernels</a><input aria-label="Toggle navigation of geometric_kernels.kernels" checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="base/index.html">geometric_kernels.kernels.base</a></li>
<li class="toctree-l3"><a class="reference internal" href="feature_map/index.html">geometric_kernels.kernels.feature_map</a></li>
<li class="toctree-l3"><a class="reference internal" href="hodge_compositional/index.html">geometric_kernels.kernels.hodge_compositional</a></li>
<li class="toctree-l3"><a class="reference internal" href="karhunen_loeve/index.html">geometric_kernels.kernels.karhunen_loeve</a></li>
<li class="toctree-l3"><a class="reference internal" href="matern_kernel/index.html">geometric_kernels.kernels.matern_kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="matern_kernel_hamming_graph/index.html">geometric_kernels.kernels.matern_kernel_hamming_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="product/index.html">geometric_kernels.kernels.product</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lab_extras/index.html">geometric_kernels.lab_extras</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../sampling/index.html">geometric_kernels.sampling</a><input aria-label="Toggle navigation of geometric_kernels.sampling" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../sampling/samplers/index.html">geometric_kernels.sampling.samplers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spaces/index.html">geometric_kernels.spaces</a><input aria-label="Toggle navigation of geometric_kernels.spaces" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../spaces/base/index.html">geometric_kernels.spaces.base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/circle/index.html">geometric_kernels.spaces.circle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/eigenfunctions/index.html">geometric_kernels.spaces.eigenfunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/graph/index.html">geometric_kernels.spaces.graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/graph_edges/index.html">geometric_kernels.spaces.graph_edges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/hamming_graph/index.html">geometric_kernels.spaces.hamming_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/hyperbolic/index.html">geometric_kernels.spaces.hyperbolic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/hypercube_graph/index.html">geometric_kernels.spaces.hypercube_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/hypersphere/index.html">geometric_kernels.spaces.hypersphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/lie_groups/index.html">geometric_kernels.spaces.lie_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/mesh/index.html">geometric_kernels.spaces.mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/product/index.html">geometric_kernels.spaces.product</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/so/index.html">geometric_kernels.spaces.so</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/spd/index.html">geometric_kernels.spaces.spd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spaces/su/index.html">geometric_kernels.spaces.su</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tensorflow/index.html">geometric_kernels.tensorflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../torch/index.html">geometric_kernels.torch</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../utils/index.html">geometric_kernels.utils</a><input aria-label="Toggle navigation of geometric_kernels.utils" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/manifold_utils/index.html">geometric_kernels.utils.manifold_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/product/index.html">geometric_kernels.utils.product</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/special_functions/index.html">geometric_kernels.utils.special_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/utils/index.html">geometric_kernels.utils.utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../version/index.html">geometric_kernels.version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/geometric-kernels/GeometricKernels">GitHub</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../_sources/autoapi/geometric_kernels/kernels/index.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-geometric_kernels.kernels">
<span id="geometric-kernels-kernels"></span><h1>geometric_kernels.kernels<a class="headerlink" href="#module-geometric_kernels.kernels" title="Link to this heading">¶</a></h1>
<p>This module provides the abstract base class for geometric kernels and
specialized classes for various types of spaces.</p>
<p>Unless you know exactly what you are doing, always use the
<a class="reference internal" href="#geometric_kernels.kernels.MaternGeometricKernel" title="geometric_kernels.kernels.MaternGeometricKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaternGeometricKernel</span></code></a> that “just works”.</p>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="base/index.html">geometric_kernels.kernels.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature_map/index.html">geometric_kernels.kernels.feature_map</a></li>
<li class="toctree-l1"><a class="reference internal" href="hodge_compositional/index.html">geometric_kernels.kernels.hodge_compositional</a></li>
<li class="toctree-l1"><a class="reference internal" href="karhunen_loeve/index.html">geometric_kernels.kernels.karhunen_loeve</a></li>
<li class="toctree-l1"><a class="reference internal" href="matern_kernel/index.html">geometric_kernels.kernels.matern_kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="matern_kernel_hamming_graph/index.html">geometric_kernels.kernels.matern_kernel_hamming_graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="product/index.html">geometric_kernels.kernels.product</a></li>
</ul>
</div>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="geometric_kernels.kernels.BaseGeometricKernel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geometric_kernels.kernels.</span></span><span class="sig-name descname"><span class="pre">BaseGeometricKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/base.html#BaseGeometricKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.BaseGeometricKernel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Abstract base class for geometric kernels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>space</strong> (<a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Space" title="geometric_kernels.spaces.Space"><em>geometric_kernels.spaces.Space</em></a>) – The space on which the kernel is defined.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.BaseGeometricKernel.K">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">K</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/base.html#BaseGeometricKernel.K"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.BaseGeometricKernel.K" title="Link to this definition">¶</a></dt>
<dd><p>Compute the cross-covariance matrix between two batches of vectors of
inputs, or batches of matrices of inputs, depending on the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.Numeric</em><em>]</em>) – <p>A dict of kernel parameters, typically containing two keys:
<cite>“lengthscale”</cite> for length scale and <cite>“nu”</cite> for smoothness.</p>
<p>The types of values in the params dict determine the output type
and the backend used for the internal computations, see the
warning below for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values <cite>params[“lengthscale”]</cite> and <cite>params[“nu”]</cite> are
typically (1,)-shaped arrays of the suitable backend. This
serves to point at the backend to be used for internal
computations.</p>
<p>In some cases, for example, when the kernel is
<a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel" title="geometric_kernels.kernels.ProductGeometricKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProductGeometricKernel</span></code></a>, the values of
<cite>params</cite> may be (s,)-shaped arrays instead, where <cite>s</cite> is the
number of factors.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Finite values of <cite>params[“nu”]</cite> typically correspond to the
generalized (geometric) Matérn kernels.</p>
<p>Infinite <cite>params[“nu”]</cite> typically corresponds to the heat
kernel (a.k.a. diffusion kernel, generalized squared
exponential kernel, generalized Gaussian kernel,
generalized RBF kernel). Although it is often considered to be
a separate entity, we treat the heat kernel as a member of
the Matérn family, with smoothness parameter equal to infinity.</p>
</div>
</p></li>
<li><p><strong>X</strong> (<em>lab.Numeric</em>) – A batch of N inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p></li>
<li><p><strong>X2</strong> (<em>beartype.typing.Optional</em><em>[</em><em>lab.Numeric</em><em>]</em>) – <p>A batch of M inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p>
<p><cite>X2=None</cite> sets <cite>X2=X1</cite>.</p>
<p>Defaults to None.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The N x M cross-covariance matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lab.Numeric</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The types of values in the <cite>params</cite> dict determine the backend
used for internal computations and the output type.</p>
<p>Even if, say, <cite>geometric_kernels.jax</cite> is imported but the values in
the <cite>params</cite> dict are NumPy arrays, the output type will be a NumPy
array, and NumPy will be used for internal computations. To get a
JAX array as an output and use JAX for internal computations, all
the values in the <cite>params</cite> dict must be JAX arrays.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.BaseGeometricKernel.K_diag">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">K_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/base.html#BaseGeometricKernel.K_diag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.BaseGeometricKernel.K_diag" title="Link to this definition">¶</a></dt>
<dd><p>Returns the diagonal of the covariance matrix <cite>self.K(params, X, X)</cite>,
typically in a more efficient way than actually computing the full
covariance matrix with <cite>self.K(params, X, X)</cite> and then extracting its
diagonal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.Numeric</em><em>]</em>) – Same as for <a class="reference internal" href="#geometric_kernels.kernels.BaseGeometricKernel.K" title="geometric_kernels.kernels.BaseGeometricKernel.K"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K()</span></code></a>.</p></li>
<li><p><strong>X</strong> (<em>lab.Numeric</em>) – A batch of N inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The N-dimensional vector representing the diagonal of the
covariance matrix <cite>self.K(params, X, X)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lab.Numeric</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.BaseGeometricKernel.init_params">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/base.html#BaseGeometricKernel.init_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.BaseGeometricKernel.init_params" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the dict of the trainable parameters of the kernel.</p>
<p>It typically contains only two keys: <cite>“nu”</cite> and <cite>“lengthscale”</cite>.</p>
<p>This dict can be modified and is passed around into such methods as
<a class="reference internal" href="#geometric_kernels.kernels.BaseGeometricKernel.K" title="geometric_kernels.kernels.BaseGeometricKernel.K"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K()</span></code></a> or <a class="reference internal" href="#geometric_kernels.kernels.BaseGeometricKernel.K_diag" title="geometric_kernels.kernels.BaseGeometricKernel.K_diag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K_diag()</span></code></a>, as the <cite>params</cite> argument.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values in the returned dict are always of the NumPy array type.
Thus, if you want to use some other backend for internal
computations when calling <a class="reference internal" href="#geometric_kernels.kernels.BaseGeometricKernel.K" title="geometric_kernels.kernels.BaseGeometricKernel.K"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K()</span></code></a> or <a class="reference internal" href="#geometric_kernels.kernels.BaseGeometricKernel.K_diag" title="geometric_kernels.kernels.BaseGeometricKernel.K_diag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K_diag()</span></code></a>, you
need to replace the values with the analogs typed as arrays of
the desired backend.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>beartype.typing.Dict[str, lab.NPNumeric]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geometric_kernels.kernels.BaseGeometricKernel.space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">beartype.typing.Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Space" title="geometric_kernels.spaces.Space"><span class="pre">geometric_kernels.spaces.Space</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">beartype.typing.List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Space" title="geometric_kernels.spaces.Space"><span class="pre">geometric_kernels.spaces.Space</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#geometric_kernels.kernels.BaseGeometricKernel.space" title="Link to this definition">¶</a></dt>
<dd><p>The space on which the kernel is defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>beartype.typing.Union[<a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Space" title="geometric_kernels.spaces.Space">geometric_kernels.spaces.Space</a>, beartype.typing.List[<a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Space" title="geometric_kernels.spaces.Space">geometric_kernels.spaces.Space</a>]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternFeatureMapKernel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geometric_kernels.kernels.</span></span><span class="sig-name descname"><span class="pre">MaternFeatureMapKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/feature_map.html#MaternFeatureMapKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternFeatureMapKernel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="base/index.html#geometric_kernels.kernels.base.BaseGeometricKernel" title="geometric_kernels.kernels.base.BaseGeometricKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geometric_kernels.kernels.base.BaseGeometricKernel</span></code></a></p>
<p>This class computes a (Matérn) kernel based on a feature map.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[k_{\nu, \kappa}(x, y) = \langle \phi_{\nu, \kappa}(x), \phi_{\nu, \kappa}(y) \rangle_{\mathbb{R}^n}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\langle \cdot , \cdot \rangle_{\mathbb{R}^n}\)</span> is the standard inner
product in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> and <span class="math notranslate nohighlight">\(\phi_{\nu, \kappa}: X \to \mathbb{R}^n\)</span> is
an arbitrary function called <em>feature map</em>. We assume that it depends
on the smoothness and length scale parameters <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(\kappa\)</span>,
respectively, which makes this kernel specifically Matérn.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A brief introduction into feature maps and related kernels can be
found on <a class="reference internal" href="../../../theory/feature_maps.html"><span class="doc">this page</span></a>.</p>
<p>Note that the finite-dimensional feature maps this kernel is meant to
be used with are, in most cases, some approximations of the
intractable infinite-dimensional feature maps.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="../spaces/base/index.html#geometric_kernels.spaces.base.Space" title="geometric_kernels.spaces.base.Space"><em>geometric_kernels.spaces.base.Space</em></a>) – The space on which the kernel is defined.</p></li>
<li><p><strong>feature_map</strong> (<a class="reference internal" href="../feature_maps/index.html#geometric_kernels.feature_maps.FeatureMap" title="geometric_kernels.feature_maps.FeatureMap"><em>geometric_kernels.feature_maps.FeatureMap</em></a>) – A <a class="reference internal" href="../feature_maps/index.html#geometric_kernels.feature_maps.FeatureMap" title="geometric_kernels.feature_maps.FeatureMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureMap</span></code></a> object that represents an
arbitrary function <span class="math notranslate nohighlight">\(\phi_{\nu, \kappa}: X \to \mathbb{R}^n\)</span>, where
<span class="math notranslate nohighlight">\(X\)</span> is the <cite>space</cite>, <span class="math notranslate nohighlight">\(n\)</span> can be an arbitrary finite integer, and
<span class="math notranslate nohighlight">\(\nu, \kappa\)</span> are the smoothness and length scale parameters.</p></li>
<li><p><strong>key</strong> (<em>lab.RandomState</em>) – <p>Random state, either <cite>np.random.RandomState</cite>,
<cite>tf.random.Generator</cite>, <cite>torch.Generator</cite> or <cite>jax.tensor</cite> (which
represents a random state).</p>
<p>Many feature maps used in the library are randomized, thus requiring a
<cite>key</cite> to work. The <a class="reference internal" href="#geometric_kernels.kernels.MaternFeatureMapKernel" title="geometric_kernels.kernels.MaternFeatureMapKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaternFeatureMapKernel</span></code></a> uses this <cite>key</cite> to
make them (and thus the kernel) deterministic, applying the utility
function <a class="reference internal" href="../utils/utils/index.html#geometric_kernels.utils.utils.make_deterministic" title="geometric_kernels.utils.utils.make_deterministic"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_deterministic()</span></code></a> to the pair <cite>feature_map, key</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even if the <cite>feature_map</cite> is deterministic, you need to provide a
valid key, although it will essentially be ignored. In the future,
we should probably make the <cite>key</cite> parameter optional.</p>
</div>
</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – <p>This parameter is directly passed on to the <cite>feature_map</cite> as a keyword
argument “normalize”. If normalize=True, then either <span class="math notranslate nohighlight">\(k(x, x) = 1\)</span> for
all <span class="math notranslate nohighlight">\(x \in X\)</span>, or <span class="math notranslate nohighlight">\(\int_X k(x, x) d x = 1\)</span>, depending on the type of
the feature map and on the space <span class="math notranslate nohighlight">\(X\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For many kernel methods, <span class="math notranslate nohighlight">\(k(\cdot, \cdot)\)</span> and <span class="math notranslate nohighlight">\(a k(\cdot, \cdot)\)</span>
are indistinguishable, whatever the positive constant <span class="math notranslate nohighlight">\(a\)</span> is. For
these, it makes sense to use normalize=False to save up some
computational overhead. For others, like for the Gaussian process
regression, the normalization of the kernel might be important. In
these cases, you will typically want to set normalize=True.</p>
</div>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternFeatureMapKernel.K">
<span class="sig-name descname"><span class="pre">K</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/feature_map.html#MaternFeatureMapKernel.K"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternFeatureMapKernel.K" title="Link to this definition">¶</a></dt>
<dd><p>Compute the cross-covariance matrix between two batches of vectors of
inputs, or batches of matrices of inputs, depending on the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.Numeric</em><em>]</em>) – <p>A dict of kernel parameters, typically containing two keys:
<cite>“lengthscale”</cite> for length scale and <cite>“nu”</cite> for smoothness.</p>
<p>The types of values in the params dict determine the output type
and the backend used for the internal computations, see the
warning below for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values <cite>params[“lengthscale”]</cite> and <cite>params[“nu”]</cite> are
typically (1,)-shaped arrays of the suitable backend. This
serves to point at the backend to be used for internal
computations.</p>
<p>In some cases, for example, when the kernel is
<a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel" title="geometric_kernels.kernels.ProductGeometricKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProductGeometricKernel</span></code></a>, the values of
<cite>params</cite> may be (s,)-shaped arrays instead, where <cite>s</cite> is the
number of factors.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Finite values of <cite>params[“nu”]</cite> typically correspond to the
generalized (geometric) Matérn kernels.</p>
<p>Infinite <cite>params[“nu”]</cite> typically corresponds to the heat
kernel (a.k.a. diffusion kernel, generalized squared
exponential kernel, generalized Gaussian kernel,
generalized RBF kernel). Although it is often considered to be
a separate entity, we treat the heat kernel as a member of
the Matérn family, with smoothness parameter equal to infinity.</p>
</div>
</p></li>
<li><p><strong>X</strong> (<em>lab.Numeric</em>) – A batch of N inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p></li>
<li><p><strong>X2</strong> (<em>beartype.typing.Optional</em><em>[</em><em>lab.Numeric</em><em>]</em>) – <p>A batch of M inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p>
<p><cite>X2=None</cite> sets <cite>X2=X1</cite>.</p>
<p>Defaults to None.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The N x M cross-covariance matrix.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The types of values in the <cite>params</cite> dict determine the backend
used for internal computations and the output type.</p>
<p>Even if, say, <cite>geometric_kernels.jax</cite> is imported but the values in
the <cite>params</cite> dict are NumPy arrays, the output type will be a NumPy
array, and NumPy will be used for internal computations. To get a
JAX array as an output and use JAX for internal computations, all
the values in the <cite>params</cite> dict must be JAX arrays.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternFeatureMapKernel.K_diag">
<span class="sig-name descname"><span class="pre">K_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/feature_map.html#MaternFeatureMapKernel.K_diag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternFeatureMapKernel.K_diag" title="Link to this definition">¶</a></dt>
<dd><p>Returns the diagonal of the covariance matrix <cite>self.K(params, X, X)</cite>,
typically in a more efficient way than actually computing the full
covariance matrix with <cite>self.K(params, X, X)</cite> and then extracting its
diagonal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.Numeric</em><em>]</em>) – Same as for <a class="reference internal" href="#geometric_kernels.kernels.MaternFeatureMapKernel.K" title="geometric_kernels.kernels.MaternFeatureMapKernel.K"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K()</span></code></a>.</p></li>
<li><p><strong>X</strong> (<em>lab.Numeric</em>) – A batch of N inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The N-dimensional vector representing the diagonal of the
covariance matrix <cite>self.K(params, X, X)</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternFeatureMapKernel.init_params">
<span class="sig-name descname"><span class="pre">init_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/feature_map.html#MaternFeatureMapKernel.init_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternFeatureMapKernel.init_params" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the dict of the trainable parameters of the kernel.</p>
<p>Returns <cite>dict(nu=np.array([np.inf]), lengthscale=np.array([1.0]))</cite>.</p>
<p>This dict can be modified and is passed around into such methods as
<a class="reference internal" href="#geometric_kernels.kernels.MaternFeatureMapKernel.K" title="geometric_kernels.kernels.MaternFeatureMapKernel.K"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K()</span></code></a> or <a class="reference internal" href="#geometric_kernels.kernels.MaternFeatureMapKernel.K_diag" title="geometric_kernels.kernels.MaternFeatureMapKernel.K_diag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K_diag()</span></code></a>, as the <cite>params</cite> argument.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values in the returned dict are always of the NumPy array type.
Thus, if you want to use some other backend for internal
computations when calling <a class="reference internal" href="#geometric_kernels.kernels.MaternFeatureMapKernel.K" title="geometric_kernels.kernels.MaternFeatureMapKernel.K"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K()</span></code></a> or <a class="reference internal" href="#geometric_kernels.kernels.MaternFeatureMapKernel.K_diag" title="geometric_kernels.kernels.MaternFeatureMapKernel.K_diag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K_diag()</span></code></a>, you
need to replace the values with the analogs typed as arrays of
the desired backend.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>beartype.typing.Dict[str, lab.NPNumeric]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternGeometricKernel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geometric_kernels.kernels.</span></span><span class="sig-name descname"><span class="pre">MaternGeometricKernel</span></span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/matern_kernel.html#MaternGeometricKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternGeometricKernel" title="Link to this definition">¶</a></dt>
<dd><p>This class represents a Matérn geometric kernel that “just works”. Unless
you really know what you are doing, you should always use this kernel class.</p>
<p>Upon creation, unpacks into a specific geometric kernel based on the
provided space, and, optionally, the associated (approximate) feature map.</p>
<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternGeometricKernel.__new__">
<span class="sig-name descname"><span class="pre">__new__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_feature_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/matern_kernel.html#MaternGeometricKernel.__new__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternGeometricKernel.__new__" title="Link to this definition">¶</a></dt>
<dd><p>Construct a kernel and (if <cite>return_feature_map</cite> is <cite>True</cite>) a
feature map on <cite>space</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="../../../theory/feature_maps.html"><span class="doc">this page</span></a> for a brief
introduction into feature maps.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Space" title="geometric_kernels.spaces.Space"><em>geometric_kernels.spaces.Space</em></a>) – Space to construct the kernel on.</p></li>
<li><p><strong>num</strong> (<em>int</em>) – <p>If provided, controls the “order of approximation” of the kernel.
For the discrete spectrum spaces, this means the number of “levels”
that go into the truncated series that defines the kernel (for
example, these are unique eigenvalues for the
<a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Hypersphere" title="geometric_kernels.spaces.Hypersphere"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hypersphere</span></code></a> or eigenvalues with repetitions for
the <a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Graph" title="geometric_kernels.spaces.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a> or for the <a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Mesh" title="geometric_kernels.spaces.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>).
For the non-compact symmetric spaces
(<a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.NoncompactSymmetricSpace" title="geometric_kernels.spaces.NoncompactSymmetricSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoncompactSymmetricSpace</span></code></a>), this is the number
of random phases used to construct the kernel.</p>
<p>If num=None, we use a (hopefully) reasonable default, which is
space-dependent.</p>
</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – <p>Normalize the kernel (and the feature map). If normalize=True,
then either <span class="math notranslate nohighlight">\(k(x, x) = 1\)</span> for all <span class="math notranslate nohighlight">\(x \in X\)</span>, where <span class="math notranslate nohighlight">\(X\)</span> is the
<cite>space</cite>, or <span class="math notranslate nohighlight">\(\int_X k(x, x) d x = 1\)</span>, depending on the space.</p>
<p>Defaults to True.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For many kernel methods, <span class="math notranslate nohighlight">\(k(\cdot, \cdot)\)</span> and
<span class="math notranslate nohighlight">\(a k(\cdot, \cdot)\)</span> are indistinguishable, whatever the
positive constant <span class="math notranslate nohighlight">\(a\)</span> is. For these, it makes sense to use
normalize=False to save up some computational overhead. For
others, like for the Gaussian process regression, the
normalization of the kernel might be important. In
these cases, you will typically want to set normalize=True.</p>
</div>
</p></li>
<li><p><strong>return_feature_map</strong> (<em>bool</em>) – <p>If <cite>True</cite>, return a feature map (needed e.g. for efficient sampling
from Gaussian processes) along with the kernel.</p>
<p>Default is False.</p>
</p></li>
<li><p><strong>**kwargs</strong> – Any additional keyword arguments to be passed to the kernel
(like <cite>key</cite>).</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For non-compact symmetric spaces, like <a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Hyperbolic" title="geometric_kernels.spaces.Hyperbolic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hyperbolic</span></code></a>
or <a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.SymmetricPositiveDefiniteMatrices" title="geometric_kernels.spaces.SymmetricPositiveDefiniteMatrices"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymmetricPositiveDefiniteMatrices</span></code></a>, the <cite>key</cite>
<strong>must</strong> be provided in <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternHodgeCompositionalKernel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geometric_kernels.kernels.</span></span><span class="sig-name descname"><span class="pre">MaternHodgeCompositionalKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/hodge_compositional.html#MaternHodgeCompositionalKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternHodgeCompositionalKernel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="base/index.html#geometric_kernels.kernels.base.BaseGeometricKernel" title="geometric_kernels.kernels.base.BaseGeometricKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geometric_kernels.kernels.base.BaseGeometricKernel</span></code></a></p>
<p>This class is similar to <a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel" title="geometric_kernels.kernels.MaternKarhunenLoeveKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel</span></code></a>, but
provides a more expressive family of kernels on the spaces where Hodge
decomposition is available.</p>
<p>The resulting kernel is a sum of three kernels,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[k(x, x') = a k_{\text{harmonic}}(x, x') + b k_{\text{gradient}}(x, x') + c k_{\text{curl}}(x, x'),\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(a, b, c\)</span> are weights <span class="math notranslate nohighlight">\(a, b, c \geq 0\)</span> and <span class="math notranslate nohighlight">\(a + b + c = 1\)</span>, and
<span class="math notranslate nohighlight">\(k_{\text{harmonic}}\)</span>, <span class="math notranslate nohighlight">\(k_{\text{gradient}}\)</span>, <span class="math notranslate nohighlight">\(k_{\text{curl}}\)</span> are the
instances of <a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel" title="geometric_kernels.kernels.MaternKarhunenLoeveKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel</span></code></a> that only use the
eigenpairs of the Laplacian corresponding to a single part of the Hodge
decomposition.</p>
<p>The parameters of this kernel are represented by a dict with three keys:
<cite>“harmonic”</cite>, <cite>“gradient”</cite>, <cite>“curl”</cite>, each corresponding to a dict with
keys <cite>“logit”</cite>, <cite>“nu”</cite>, <cite>“lengthscale”</cite>, where <cite>“nu”</cite> and <cite>“lengthscale”</cite>
are the parameters of the respective <a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel" title="geometric_kernels.kernels.MaternKarhunenLoeveKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel</span></code></a>,
while the <cite>“logit”</cite> parameters determine the weights <span class="math notranslate nohighlight">\(a, b, c\)</span> in the
formula above: <span class="math notranslate nohighlight">\(a, b, c\)</span> are the <cite>“logit”</cite> parameters normalized to
satisfy <span class="math notranslate nohighlight">\(a + b + c = 1\)</span>.</p>
<p>Same as for <a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel" title="geometric_kernels.kernels.MaternKarhunenLoeveKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel</span></code></a>, these kernels can sometimes
be computed more efficiently using addition theorems.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A brief introduction into the theory behind
<a class="reference internal" href="#geometric_kernels.kernels.MaternHodgeCompositionalKernel" title="geometric_kernels.kernels.MaternHodgeCompositionalKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaternHodgeCompositionalKernel</span></code></a> can be found in
<a class="reference internal" href="../../../theory/graphs.html"><span class="doc">this</span></a> documentation page.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.HodgeDiscreteSpectrumSpace" title="geometric_kernels.spaces.HodgeDiscreteSpectrumSpace"><em>geometric_kernels.spaces.HodgeDiscreteSpectrumSpace</em></a>) – The space to define the kernel upon, a subclass of <a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.HodgeDiscreteSpectrumSpace" title="geometric_kernels.spaces.HodgeDiscreteSpectrumSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">HodgeDiscreteSpectrumSpace</span></code></a>.</p></li>
<li><p><strong>num_levels</strong> (<em>int</em>) – Number of levels to include in the summation.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Whether to normalize kernel to have unit average variance.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternHodgeCompositionalKernel.K">
<span class="sig-name descname"><span class="pre">K</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/hodge_compositional.html#MaternHodgeCompositionalKernel.K"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternHodgeCompositionalKernel.K" title="Link to this definition">¶</a></dt>
<dd><p>Compute the cross-covariance matrix between two batches of vectors of
inputs, or batches of matrices of inputs, depending on the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.NPNumeric</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>X</strong> (<em>lab.Numeric</em>)</p></li>
<li><p><strong>X2</strong> (<em>beartype.typing.Optional</em><em>[</em><em>lab.Numeric</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>lab.Numeric</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternHodgeCompositionalKernel.K_diag">
<span class="sig-name descname"><span class="pre">K_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/hodge_compositional.html#MaternHodgeCompositionalKernel.K_diag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternHodgeCompositionalKernel.K_diag" title="Link to this definition">¶</a></dt>
<dd><p>Returns the diagonal of the covariance matrix <cite>self.K(params, X, X)</cite>,
typically in a more efficient way than actually computing the full
covariance matrix with <cite>self.K(params, X, X)</cite> and then extracting its
diagonal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.NPNumeric</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>X</strong> (<em>lab.Numeric</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>lab.Numeric</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternHodgeCompositionalKernel.init_params">
<span class="sig-name descname"><span class="pre">init_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/hodge_compositional.html#MaternHodgeCompositionalKernel.init_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternHodgeCompositionalKernel.init_params" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the three sets of parameters for the three kernels.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>beartype.typing.Dict[str, beartype.typing.Dict[str, lab.NPNumeric]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternHodgeCompositionalKernel.space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.HodgeDiscreteSpectrumSpace" title="geometric_kernels.spaces.HodgeDiscreteSpectrumSpace"><span class="pre">geometric_kernels.spaces.HodgeDiscreteSpectrumSpace</span></a></em><a class="headerlink" href="#geometric_kernels.kernels.MaternHodgeCompositionalKernel.space" title="Link to this definition">¶</a></dt>
<dd><p>The space on which the kernel is defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.HodgeDiscreteSpectrumSpace" title="geometric_kernels.spaces.HodgeDiscreteSpectrumSpace">geometric_kernels.spaces.HodgeDiscreteSpectrumSpace</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKarhunenLoeveKernel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geometric_kernels.kernels.</span></span><span class="sig-name descname"><span class="pre">MaternKarhunenLoeveKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvalues_laplacian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenfunctions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/karhunen_loeve.html#MaternKarhunenLoeveKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="base/index.html#geometric_kernels.kernels.base.BaseGeometricKernel" title="geometric_kernels.kernels.base.BaseGeometricKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geometric_kernels.kernels.base.BaseGeometricKernel</span></code></a></p>
<p>This class approximates Matérn kernel by its truncated Mercer decomposition,
in terms of the eigenfunctions &amp; eigenvalues of the Laplacian on the space.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[k(x, x') = \sum_{l=0}^{L-1} S(\sqrt\lambda_l) \sum_{s=1}^{d_l} f_{ls}(x) f_{ls}(x'),\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\lambda_l\)</span> and <span class="math notranslate nohighlight">\(f_{ls}(\cdot)\)</span> are the eigenvalues and
eigenfunctions of the Laplacian such that
<span class="math notranslate nohighlight">\(\Delta f_{ls} = \lambda_l f_{ls}\)</span>, and <span class="math notranslate nohighlight">\(S(\cdot)\)</span> is the spectrum
of the Matérn kernel. The eigenvalues and eigenfunctions belong to the
<a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.DiscreteSpectrumSpace" title="geometric_kernels.spaces.DiscreteSpectrumSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiscreteSpectrumSpace</span></code></a> instance.</p>
<p>We denote</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[G_l(\cdot, \cdot') = \sum_{s=1}^{d_l} f_{ls}(\cdot) f_{ls}(\cdot')\]</div>
</div>
<p>and term the sets <span class="math notranslate nohighlight">\([f_{ls}]_{s=1}^{d_l}\)</span>  <em>“levels”</em>.</p>
<p>For many spaces, like the sphere, we can employ addition
theorems to efficiently compute <span class="math notranslate nohighlight">\(G_l(\cdot, \cdot')\)</span> without calculating
the individual <span class="math notranslate nohighlight">\(f_{ls}(\cdot)\)</span>. Note that <span class="math notranslate nohighlight">\(\lambda_l\)</span> are not required to
be unique: it is possible that for some <span class="math notranslate nohighlight">\(l,l'\)</span>, <span class="math notranslate nohighlight">\(\lambda_l = \lambda_{l'}\)</span>.
In other words, the “levels” do not necessarily correspond to full
eigenspaces. A level may even correspond to a single eigenfunction.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A brief introduction into the theory behind
<a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel" title="geometric_kernels.kernels.MaternKarhunenLoeveKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel</span></code></a> can be found in
<a class="reference internal" href="../../../theory/compact.html"><span class="doc">this</span></a> &amp; <a class="reference internal" href="../../../theory/addition_theorem.html"><span class="doc">this</span></a>
documentation pages.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.DiscreteSpectrumSpace" title="geometric_kernels.spaces.DiscreteSpectrumSpace"><em>geometric_kernels.spaces.DiscreteSpectrumSpace</em></a>) – The space to define the kernel upon.</p></li>
<li><p><strong>num_levels</strong> (<em>int</em>) – Number of levels to include in the summation.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Whether to normalize kernel to have unit average variance.</p></li>
<li><p><strong>eigenvalues_laplacian</strong> (<em>beartype.typing.Optional</em><em>[</em><em>lab.Numeric</em><em>]</em>) – Allowing to pass the eigenvalues of the Laplacian directly, instead of
computing them from the space. If provided, <cite>eigenfunctions</cite> must also
be provided. Used for <a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.HodgeDiscreteSpectrumSpace" title="geometric_kernels.spaces.HodgeDiscreteSpectrumSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">HodgeDiscreteSpectrumSpace</span></code></a>.</p></li>
<li><p><strong>eigenfunctions</strong> (<em>beartype.typing.Optional</em><em>[</em><a class="reference internal" href="../spaces/eigenfunctions/index.html#geometric_kernels.spaces.eigenfunctions.Eigenfunctions" title="geometric_kernels.spaces.eigenfunctions.Eigenfunctions"><em>geometric_kernels.spaces.eigenfunctions.Eigenfunctions</em></a><em>]</em>) – Allowing to pass the eigenfunctions directly, instead of computing them
from the space. If provided, <cite>eigenvalues_laplacian</cite> must also be provided.
Used for <a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.HodgeDiscreteSpectrumSpace" title="geometric_kernels.spaces.HodgeDiscreteSpectrumSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">HodgeDiscreteSpectrumSpace</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKarhunenLoeveKernel.K">
<span class="sig-name descname"><span class="pre">K</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/karhunen_loeve.html#MaternKarhunenLoeveKernel.K"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.K" title="Link to this definition">¶</a></dt>
<dd><p>Compute the cross-covariance matrix between two batches of vectors of
inputs, or batches of matrices of inputs, depending on the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.Numeric</em><em>]</em>) – <p>A dict of kernel parameters, typically containing two keys:
<cite>“lengthscale”</cite> for length scale and <cite>“nu”</cite> for smoothness.</p>
<p>The types of values in the params dict determine the output type
and the backend used for the internal computations, see the
warning below for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values <cite>params[“lengthscale”]</cite> and <cite>params[“nu”]</cite> are
typically (1,)-shaped arrays of the suitable backend. This
serves to point at the backend to be used for internal
computations.</p>
<p>In some cases, for example, when the kernel is
<a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel" title="geometric_kernels.kernels.ProductGeometricKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProductGeometricKernel</span></code></a>, the values of
<cite>params</cite> may be (s,)-shaped arrays instead, where <cite>s</cite> is the
number of factors.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Finite values of <cite>params[“nu”]</cite> typically correspond to the
generalized (geometric) Matérn kernels.</p>
<p>Infinite <cite>params[“nu”]</cite> typically corresponds to the heat
kernel (a.k.a. diffusion kernel, generalized squared
exponential kernel, generalized Gaussian kernel,
generalized RBF kernel). Although it is often considered to be
a separate entity, we treat the heat kernel as a member of
the Matérn family, with smoothness parameter equal to infinity.</p>
</div>
</p></li>
<li><p><strong>X</strong> (<em>lab.Numeric</em>) – A batch of N inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p></li>
<li><p><strong>X2</strong> (<em>beartype.typing.Optional</em><em>[</em><em>lab.Numeric</em><em>]</em>) – <p>A batch of M inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p>
<p><cite>X2=None</cite> sets <cite>X2=X1</cite>.</p>
<p>Defaults to None.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The N x M cross-covariance matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lab.Numeric</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The types of values in the <cite>params</cite> dict determine the backend
used for internal computations and the output type.</p>
<p>Even if, say, <cite>geometric_kernels.jax</cite> is imported but the values in
the <cite>params</cite> dict are NumPy arrays, the output type will be a NumPy
array, and NumPy will be used for internal computations. To get a
JAX array as an output and use JAX for internal computations, all
the values in the <cite>params</cite> dict must be JAX arrays.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKarhunenLoeveKernel.K_diag">
<span class="sig-name descname"><span class="pre">K_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/karhunen_loeve.html#MaternKarhunenLoeveKernel.K_diag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.K_diag" title="Link to this definition">¶</a></dt>
<dd><p>Returns the diagonal of the covariance matrix <cite>self.K(params, X, X)</cite>,
typically in a more efficient way than actually computing the full
covariance matrix with <cite>self.K(params, X, X)</cite> and then extracting its
diagonal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.Numeric</em><em>]</em>) – Same as for <a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.K" title="geometric_kernels.kernels.MaternKarhunenLoeveKernel.K"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K()</span></code></a>.</p></li>
<li><p><strong>X</strong> (<em>lab.Numeric</em>) – A batch of N inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The N-dimensional vector representing the diagonal of the
covariance matrix <cite>self.K(params, X, X)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lab.Numeric</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKarhunenLoeveKernel.eigenvalues">
<span class="sig-name descname"><span class="pre">eigenvalues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/karhunen_loeve.html#MaternKarhunenLoeveKernel.eigenvalues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.eigenvalues" title="Link to this definition">¶</a></dt>
<dd><p>Eigenvalues of the kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.Numeric</em><em>]</em>) – Parameters of the kernel. Must contain keys <cite>“lengthscale”</cite> and
<cite>“nu”</cite>. The shapes of <cite>params[“lengthscale”]</cite> and <cite>params[“nu”]</cite>
are <cite>(1,)</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An [L, 1]-shaped array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lab.Numeric</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKarhunenLoeveKernel.init_params">
<span class="sig-name descname"><span class="pre">init_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/karhunen_loeve.html#MaternKarhunenLoeveKernel.init_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.init_params" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the dict of the trainable parameters of the kernel.</p>
<p>Returns <cite>dict(nu=np.array([np.inf]), lengthscale=np.array([1.0]))</cite>.</p>
<p>This dict can be modified and is passed around into such methods as
<a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.K" title="geometric_kernels.kernels.MaternKarhunenLoeveKernel.K"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K()</span></code></a> or <a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.K_diag" title="geometric_kernels.kernels.MaternKarhunenLoeveKernel.K_diag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K_diag()</span></code></a>, as the <cite>params</cite> argument.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values in the returned dict are always of the NumPy array type.
Thus, if you want to use some other backend for internal
computations when calling <a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.K" title="geometric_kernels.kernels.MaternKarhunenLoeveKernel.K"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K()</span></code></a> or <a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.K_diag" title="geometric_kernels.kernels.MaternKarhunenLoeveKernel.K_diag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K_diag()</span></code></a>, you
need to replace the values with the analogs typed as arrays of
the desired backend.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>beartype.typing.Dict[str, lab.NPNumeric]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKarhunenLoeveKernel.spectrum">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/karhunen_loeve.html#MaternKarhunenLoeveKernel.spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.spectrum" title="Link to this definition">¶</a></dt>
<dd><p>Static method computing the spectrum of the Matérn kernel with
hyperparameters <cite>nu</cite> and <cite>lengthscale</cite> on the space with eigenvalues <cite>s</cite>
and dimension <cite>dimension</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>lab.Numeric</em>) – The eigenvalues of the space.</p></li>
<li><p><strong>nu</strong> (<em>lab.Numeric</em>) – The smoothness parameter of the kernel.</p></li>
<li><p><strong>lengthscale</strong> (<em>lab.Numeric</em>) – The length scale parameter of the kernel.</p></li>
<li><p><strong>dimension</strong> (<em>int</em>) – The dimension of the space.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The spectrum of the Matérn kernel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lab.Numeric</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKarhunenLoeveKernel.eigenfunctions">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eigenfunctions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../spaces/eigenfunctions/index.html#geometric_kernels.spaces.eigenfunctions.Eigenfunctions" title="geometric_kernels.spaces.eigenfunctions.Eigenfunctions"><span class="pre">geometric_kernels.spaces.eigenfunctions.Eigenfunctions</span></a></em><a class="headerlink" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.eigenfunctions" title="Link to this definition">¶</a></dt>
<dd><p>Eigenfunctions of the kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../spaces/eigenfunctions/index.html#geometric_kernels.spaces.eigenfunctions.Eigenfunctions" title="geometric_kernels.spaces.eigenfunctions.Eigenfunctions">geometric_kernels.spaces.eigenfunctions.Eigenfunctions</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKarhunenLoeveKernel.eigenvalues_laplacian">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eigenvalues_laplacian</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">lab.Numeric</span></em><a class="headerlink" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.eigenvalues_laplacian" title="Link to this definition">¶</a></dt>
<dd><p>Eigenvalues of the Laplacian.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lab.Numeric</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKarhunenLoeveKernel.space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.DiscreteSpectrumSpace" title="geometric_kernels.spaces.DiscreteSpectrumSpace"><span class="pre">geometric_kernels.spaces.DiscreteSpectrumSpace</span></a></em><a class="headerlink" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.space" title="Link to this definition">¶</a></dt>
<dd><p>The space on which the kernel is defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.DiscreteSpectrumSpace" title="geometric_kernels.spaces.DiscreteSpectrumSpace">geometric_kernels.spaces.DiscreteSpectrumSpace</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKernelHammingGraph">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geometric_kernels.kernels.</span></span><span class="sig-name descname"><span class="pre">MaternKernelHammingGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvalues_laplacian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenfunctions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/matern_kernel_hamming_graph.html#MaternKernelHammingGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternKernelHammingGraph" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="karhunen_loeve/index.html#geometric_kernels.kernels.karhunen_loeve.MaternKarhunenLoeveKernel" title="geometric_kernels.kernels.karhunen_loeve.MaternKarhunenLoeveKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geometric_kernels.kernels.karhunen_loeve.MaternKarhunenLoeveKernel</span></code></a></p>
<p>For <span class="math notranslate nohighlight">\(\nu = \infty\)</span>, there exists a closed-form formula for the heat kernel
on hamming graphs <code class="xref py py-class docutils literal notranslate"><span class="pre">HammingGraph</span></code> (including the binary hypercube case
<code class="xref py py-class docutils literal notranslate"><span class="pre">HypercubeGraph</span></code>). This class extends <a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel" title="geometric_kernels.kernels.MaternKarhunenLoeveKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel</span></code></a>
to implement this formula in the case of <span class="math notranslate nohighlight">\(\nu = \infty\)</span> for efficiency.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We only use the closed form expression if <cite>num_levels</cite> is <cite>d + 1</cite> which
corresponds to exact computation. When truncated to fewer levels, we
must use the parent class implementation to ensure consistency with
feature map approximations.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<em>beartype.typing.Union</em><em>[</em><a class="reference internal" href="../spaces/hamming_graph/index.html#geometric_kernels.spaces.hamming_graph.HammingGraph" title="geometric_kernels.spaces.hamming_graph.HammingGraph"><em>geometric_kernels.spaces.hamming_graph.HammingGraph</em></a><em>, </em><a class="reference internal" href="../spaces/hypercube_graph/index.html#geometric_kernels.spaces.hypercube_graph.HypercubeGraph" title="geometric_kernels.spaces.hypercube_graph.HypercubeGraph"><em>geometric_kernels.spaces.hypercube_graph.HypercubeGraph</em></a><em>]</em>)</p></li>
<li><p><strong>num_levels</strong> (<em>int</em>)</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>)</p></li>
<li><p><strong>eigenvalues_laplacian</strong> (<em>beartype.typing.Optional</em><em>[</em><em>lab.Numeric</em><em>]</em>)</p></li>
<li><p><strong>eigenfunctions</strong> (<em>beartype.typing.Optional</em><em>[</em><a class="reference internal" href="../spaces/eigenfunctions/index.html#geometric_kernels.spaces.eigenfunctions.Eigenfunctions" title="geometric_kernels.spaces.eigenfunctions.Eigenfunctions"><em>geometric_kernels.spaces.eigenfunctions.Eigenfunctions</em></a><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKernelHammingGraph.K">
<span class="sig-name descname"><span class="pre">K</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/matern_kernel_hamming_graph.html#MaternKernelHammingGraph.K"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternKernelHammingGraph.K" title="Link to this definition">¶</a></dt>
<dd><p>Compute the cross-covariance matrix between two batches of vectors of
inputs, or batches of matrices of inputs, depending on the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.Numeric</em><em>]</em>) – <p>A dict of kernel parameters, typically containing two keys:
<cite>“lengthscale”</cite> for length scale and <cite>“nu”</cite> for smoothness.</p>
<p>The types of values in the params dict determine the output type
and the backend used for the internal computations, see the
warning below for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values <cite>params[“lengthscale”]</cite> and <cite>params[“nu”]</cite> are
typically (1,)-shaped arrays of the suitable backend. This
serves to point at the backend to be used for internal
computations.</p>
<p>In some cases, for example, when the kernel is
<a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel" title="geometric_kernels.kernels.ProductGeometricKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProductGeometricKernel</span></code></a>, the values of
<cite>params</cite> may be (s,)-shaped arrays instead, where <cite>s</cite> is the
number of factors.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Finite values of <cite>params[“nu”]</cite> typically correspond to the
generalized (geometric) Matérn kernels.</p>
<p>Infinite <cite>params[“nu”]</cite> typically corresponds to the heat
kernel (a.k.a. diffusion kernel, generalized squared
exponential kernel, generalized Gaussian kernel,
generalized RBF kernel). Although it is often considered to be
a separate entity, we treat the heat kernel as a member of
the Matérn family, with smoothness parameter equal to infinity.</p>
</div>
</p></li>
<li><p><strong>X</strong> (<em>lab.Numeric</em>) – A batch of N inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p></li>
<li><p><strong>X2</strong> (<em>beartype.typing.Optional</em><em>[</em><em>lab.Numeric</em><em>]</em>) – <p>A batch of M inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p>
<p><cite>X2=None</cite> sets <cite>X2=X1</cite>.</p>
<p>Defaults to None.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The N x M cross-covariance matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lab.Numeric</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The types of values in the <cite>params</cite> dict determine the backend
used for internal computations and the output type.</p>
<p>Even if, say, <cite>geometric_kernels.jax</cite> is imported but the values in
the <cite>params</cite> dict are NumPy arrays, the output type will be a NumPy
array, and NumPy will be used for internal computations. To get a
JAX array as an output and use JAX for internal computations, all
the values in the <cite>params</cite> dict must be JAX arrays.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.MaternKernelHammingGraph.K_diag">
<span class="sig-name descname"><span class="pre">K_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/matern_kernel_hamming_graph.html#MaternKernelHammingGraph.K_diag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.MaternKernelHammingGraph.K_diag" title="Link to this definition">¶</a></dt>
<dd><p>Returns the diagonal of the covariance matrix <cite>self.K(params, X, X)</cite>,
typically in a more efficient way than actually computing the full
covariance matrix with <cite>self.K(params, X, X)</cite> and then extracting its
diagonal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.Numeric</em><em>]</em>) – Same as for <a class="reference internal" href="#geometric_kernels.kernels.MaternKernelHammingGraph.K" title="geometric_kernels.kernels.MaternKernelHammingGraph.K"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K()</span></code></a>.</p></li>
<li><p><strong>X</strong> (<em>lab.Numeric</em>) – A batch of N inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The N-dimensional vector representing the diagonal of the
covariance matrix <cite>self.K(params, X, X)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lab.Numeric</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geometric_kernels.kernels.ProductGeometricKernel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geometric_kernels.kernels.</span></span><span class="sig-name descname"><span class="pre">ProductGeometricKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">kernels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/product.html#ProductGeometricKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.ProductGeometricKernel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="base/index.html#geometric_kernels.kernels.base.BaseGeometricKernel" title="geometric_kernels.kernels.base.BaseGeometricKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geometric_kernels.kernels.base.BaseGeometricKernel</span></code></a></p>
<p>Product kernel, defined as the product of a sequence of kernels.</p>
<p>See <a class="reference internal" href="../../../theory/product_kernels.html"><span class="doc">this page</span></a> for a brief account on
theory behind product kernels and the <a class="reference internal" href="../../../examples/Torus.html"><span class="doc">Torus.ipynb</span></a>
notebook for a tutorial on how to use them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*kernels</strong> (<a class="reference internal" href="base/index.html#geometric_kernels.kernels.base.BaseGeometricKernel" title="geometric_kernels.kernels.base.BaseGeometricKernel"><em>geometric_kernels.kernels.base.BaseGeometricKernel</em></a>) – A sequence of kernels to compute the product of. Cannot contain another
instance of <a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel" title="geometric_kernels.kernels.ProductGeometricKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProductGeometricKernel</span></code></a>. We denote the number of
factors, i.e. the length of the “sequence”, by s.</p></li>
<li><p><strong>dimension_indices</strong> (<em>beartype.typing.Optional</em><em>[</em><em>beartype.typing.List</em><em>[</em><em>beartype.typing.List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>]</em>) – <p>Determines how a product kernel input vector <cite>x</cite> is to be mapped into
the inputs <cite>xi</cite> for the factor kernels. <cite>xi</cite> are assumed to be equal to
<cite>x[dimension_indices[i]]</cite>, possibly up to a reshape. Such a reshape
might be necessary to accommodate the spaces whose elements are matrices
rather than vectors, as determined by <cite>element_shapes</cite>. The
transformation of <cite>x</cite> into the list of <cite>xi</cite>s is performed
by <a class="reference internal" href="../utils/product/index.html#geometric_kernels.utils.product.project_product" title="geometric_kernels.utils.product.project_product"><code class="xref py py-func docutils literal notranslate"><span class="pre">project_product()</span></code></a>.</p>
<p>If None, assumes the each input is layed-out flattened and concatenated,
in the same order as the factor spaces. In this case, the inverse to
<a class="reference internal" href="../utils/product/index.html#geometric_kernels.utils.product.project_product" title="geometric_kernels.utils.product.project_product"><code class="xref py py-func docutils literal notranslate"><span class="pre">project_product()</span></code></a> is <a class="reference internal" href="../utils/product/index.html#geometric_kernels.utils.product.make_product" title="geometric_kernels.utils.product.make_product"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_product()</span></code></a>.</p>
<p>Defaults to None.</p>
</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>params</cite> of a <a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel" title="geometric_kernels.kernels.ProductGeometricKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProductGeometricKernel</span></code></a> are such that
<cite>params[“lengthscale”]</cite> and <cite>params[“nu”]</cite> are (s,)-shaped arrays, where
<cite>s</cite> is the number of factors.</p>
<p>Basically, <cite>params[“lengthscale”][i]</cite> stores the length scale parameter
for the <cite>i</cite>-th factor kernel. Same goes for <cite>params[“nu”]</cite>. Importantly,
this enables <em>automatic relevance determination</em>-like behavior.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.ProductGeometricKernel.K">
<span class="sig-name descname"><span class="pre">K</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/product.html#ProductGeometricKernel.K"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.ProductGeometricKernel.K" title="Link to this definition">¶</a></dt>
<dd><p>Compute the cross-covariance matrix between two batches of vectors of
inputs, or batches of matrices of inputs, depending on the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>beartype.typing.Dict</em><em>[</em><em>str</em><em>, </em><em>lab.Numeric</em><em>]</em>) – <p>A dict of kernel parameters, typically containing two keys:
<cite>“lengthscale”</cite> for length scale and <cite>“nu”</cite> for smoothness.</p>
<p>The types of values in the params dict determine the output type
and the backend used for the internal computations, see the
warning below for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values <cite>params[“lengthscale”]</cite> and <cite>params[“nu”]</cite> are
typically (1,)-shaped arrays of the suitable backend. This
serves to point at the backend to be used for internal
computations.</p>
<p>In some cases, for example, when the kernel is
<a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel" title="geometric_kernels.kernels.ProductGeometricKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProductGeometricKernel</span></code></a>, the values of
<cite>params</cite> may be (s,)-shaped arrays instead, where <cite>s</cite> is the
number of factors.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Finite values of <cite>params[“nu”]</cite> typically correspond to the
generalized (geometric) Matérn kernels.</p>
<p>Infinite <cite>params[“nu”]</cite> typically corresponds to the heat
kernel (a.k.a. diffusion kernel, generalized squared
exponential kernel, generalized Gaussian kernel,
generalized RBF kernel). Although it is often considered to be
a separate entity, we treat the heat kernel as a member of
the Matérn family, with smoothness parameter equal to infinity.</p>
</div>
</p></li>
<li><p><strong>X</strong> – A batch of N inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p></li>
<li><p><strong>X2</strong> – <p>A batch of M inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p>
<p><cite>X2=None</cite> sets <cite>X2=X1</cite>.</p>
<p>Defaults to None.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The N x M cross-covariance matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lab.Numeric</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The types of values in the <cite>params</cite> dict determine the backend
used for internal computations and the output type.</p>
<p>Even if, say, <cite>geometric_kernels.jax</cite> is imported but the values in
the <cite>params</cite> dict are NumPy arrays, the output type will be a NumPy
array, and NumPy will be used for internal computations. To get a
JAX array as an output and use JAX for internal computations, all
the values in the <cite>params</cite> dict must be JAX arrays.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.ProductGeometricKernel.K_diag">
<span class="sig-name descname"><span class="pre">K_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/product.html#ProductGeometricKernel.K_diag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.ProductGeometricKernel.K_diag" title="Link to this definition">¶</a></dt>
<dd><p>Returns the diagonal of the covariance matrix <cite>self.K(params, X, X)</cite>,
typically in a more efficient way than actually computing the full
covariance matrix with <cite>self.K(params, X, X)</cite> and then extracting its
diagonal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – Same as for <a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel.K" title="geometric_kernels.kernels.ProductGeometricKernel.K"><code class="xref py py-meth docutils literal notranslate"><span class="pre">K()</span></code></a>.</p></li>
<li><p><strong>X</strong> – A batch of N inputs, each of which is a vector or a matrix,
depending on how the elements of the <cite>self.space</cite> are represented.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The N-dimensional vector representing the diagonal of the
covariance matrix <cite>self.K(params, X, X)</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geometric_kernels.kernels.ProductGeometricKernel.init_params">
<span class="sig-name descname"><span class="pre">init_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/product.html#ProductGeometricKernel.init_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.ProductGeometricKernel.init_params" title="Link to this definition">¶</a></dt>
<dd><p>Returns a dict <cite>params</cite> where <cite>params[“lengthscale”]</cite> is the
concatenation of all <cite>self.kernels[i].init_params()[“lengthscale”]</cite> and
same for <cite>params[“nu”]</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>beartype.typing.Dict[str, lab.NPNumeric]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geometric_kernels.kernels.ProductGeometricKernel.space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">beartype.typing.List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Space" title="geometric_kernels.spaces.Space"><span class="pre">geometric_kernels.spaces.Space</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#geometric_kernels.kernels.ProductGeometricKernel.space" title="Link to this definition">¶</a></dt>
<dd><p>The list of spaces upon which the factor kernels are defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>beartype.typing.List[<a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Space" title="geometric_kernels.spaces.Space">geometric_kernels.spaces.Space</a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="geometric_kernels.kernels.default_feature_map">
<span class="sig-prename descclassname"><span class="pre">geometric_kernels.kernels.</span></span><span class="sig-name descname"><span class="pre">default_feature_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/geometric_kernels/kernels/matern_kernel.html#default_feature_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geometric_kernels.kernels.default_feature_map" title="Link to this definition">¶</a></dt>
<dd><p>Constructs the default feature map for the specified space or kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="../spaces/index.html#geometric_kernels.spaces.Space" title="geometric_kernels.spaces.Space"><em>geometric_kernels.spaces.Space</em></a>) – A space to construct the feature map on. If provided, kernel must
either be omitted or set to None.</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="base/index.html#geometric_kernels.kernels.base.BaseGeometricKernel" title="geometric_kernels.kernels.base.BaseGeometricKernel"><em>geometric_kernels.kernels.base.BaseGeometricKernel</em></a>) – A kernel to construct the feature map from. If provided, <cite>space</cite> and
<cite>num</cite> must either be omitted or set to None.</p></li>
<li><p><strong>num</strong> (<em>int</em>) – Controls the number of features (dimensionality of the feature
map). If omitted or set to None, the default value for each
respective space is used. Must only be provided when
constructing a feature map on a space (not from a kernel).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Callable which is the respective feature map.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="base/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">geometric_kernels.kernels.base</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../jax/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">geometric_kernels.jax</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022-2024, the GeometricKernels Contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">geometric_kernels.kernels</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#package-contents">Package Contents</a><ul>
<li><a class="reference internal" href="#geometric_kernels.kernels.BaseGeometricKernel"><code class="docutils literal notranslate"><span class="pre">BaseGeometricKernel</span></code></a><ul>
<li><a class="reference internal" href="#geometric_kernels.kernels.BaseGeometricKernel.K"><code class="docutils literal notranslate"><span class="pre">BaseGeometricKernel.K()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.BaseGeometricKernel.K_diag"><code class="docutils literal notranslate"><span class="pre">BaseGeometricKernel.K_diag()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.BaseGeometricKernel.init_params"><code class="docutils literal notranslate"><span class="pre">BaseGeometricKernel.init_params()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.BaseGeometricKernel.space"><code class="docutils literal notranslate"><span class="pre">BaseGeometricKernel.space</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternFeatureMapKernel"><code class="docutils literal notranslate"><span class="pre">MaternFeatureMapKernel</span></code></a><ul>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternFeatureMapKernel.K"><code class="docutils literal notranslate"><span class="pre">MaternFeatureMapKernel.K()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternFeatureMapKernel.K_diag"><code class="docutils literal notranslate"><span class="pre">MaternFeatureMapKernel.K_diag()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternFeatureMapKernel.init_params"><code class="docutils literal notranslate"><span class="pre">MaternFeatureMapKernel.init_params()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternGeometricKernel"><code class="docutils literal notranslate"><span class="pre">MaternGeometricKernel</span></code></a><ul>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternGeometricKernel.__new__"><code class="docutils literal notranslate"><span class="pre">MaternGeometricKernel.__new__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternHodgeCompositionalKernel"><code class="docutils literal notranslate"><span class="pre">MaternHodgeCompositionalKernel</span></code></a><ul>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternHodgeCompositionalKernel.K"><code class="docutils literal notranslate"><span class="pre">MaternHodgeCompositionalKernel.K()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternHodgeCompositionalKernel.K_diag"><code class="docutils literal notranslate"><span class="pre">MaternHodgeCompositionalKernel.K_diag()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternHodgeCompositionalKernel.init_params"><code class="docutils literal notranslate"><span class="pre">MaternHodgeCompositionalKernel.init_params()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternHodgeCompositionalKernel.space"><code class="docutils literal notranslate"><span class="pre">MaternHodgeCompositionalKernel.space</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel"><code class="docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel</span></code></a><ul>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.K"><code class="docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel.K()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.K_diag"><code class="docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel.K_diag()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.eigenvalues"><code class="docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel.eigenvalues()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.init_params"><code class="docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel.init_params()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.spectrum"><code class="docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel.spectrum()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.eigenfunctions"><code class="docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel.eigenfunctions</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.eigenvalues_laplacian"><code class="docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel.eigenvalues_laplacian</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKarhunenLoeveKernel.space"><code class="docutils literal notranslate"><span class="pre">MaternKarhunenLoeveKernel.space</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKernelHammingGraph"><code class="docutils literal notranslate"><span class="pre">MaternKernelHammingGraph</span></code></a><ul>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKernelHammingGraph.K"><code class="docutils literal notranslate"><span class="pre">MaternKernelHammingGraph.K()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.MaternKernelHammingGraph.K_diag"><code class="docutils literal notranslate"><span class="pre">MaternKernelHammingGraph.K_diag()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel"><code class="docutils literal notranslate"><span class="pre">ProductGeometricKernel</span></code></a><ul>
<li><a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel.K"><code class="docutils literal notranslate"><span class="pre">ProductGeometricKernel.K()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel.K_diag"><code class="docutils literal notranslate"><span class="pre">ProductGeometricKernel.K_diag()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel.init_params"><code class="docutils literal notranslate"><span class="pre">ProductGeometricKernel.init_params()</span></code></a></li>
<li><a class="reference internal" href="#geometric_kernels.kernels.ProductGeometricKernel.space"><code class="docutils literal notranslate"><span class="pre">ProductGeometricKernel.space</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geometric_kernels.kernels.default_feature_map"><code class="docutils literal notranslate"><span class="pre">default_feature_map()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "processEscapes": true, "displayMath": [["\\[", "\\]"]]}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/scripts/bootstrap.min.js?v=ff982861"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>